<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libspotify: toplist.c</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>toplist.c</h1>The toplist.c example shows how you can use toplist functions. It is part of the spshell program<p>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;string.h&gt;</span>

<span class="preprocessor">#include "spshell.h"</span>
<span class="preprocessor">#include "cmd.h"</span>

<span class="keyword">static</span> <span class="keywordtype">void</span> print_album(<span class="keywordtype">int</span> index, <a name="a0"></a><a class="code" href="group__types.html#g6fd3e5de729c429fef3ff18ece6dcfad" title="An album handle.">sp_album</a> *album)
{
    printf(<span class="stringliteral">"  Album %3d: \"%s\" by \"%s\"\n"</span>, index, <a name="a1"></a><a class="code" href="group__album.html#g0e828c991a8184d60026513f944e19ad">sp_album_name</a>(album), 
           <a name="a2"></a><a class="code" href="group__artist.html#gd2895555bb48514986823733a7afe5e2">sp_artist_name</a>(<a name="a3"></a><a class="code" href="group__album.html#g42309972141dab10c32d741d357c01de">sp_album_artist</a>(album)));
}

<span class="keyword">static</span> <span class="keywordtype">void</span> print_artist(<span class="keywordtype">int</span> index, <a name="a4"></a><a class="code" href="group__types.html#g31764fbd69618c10be173c6c03d4c1bc" title="An artist handle.">sp_artist</a> *artist)
{
    printf(<span class="stringliteral">"  Artist %3d: \"%s\"\n"</span>, index, <a class="code" href="group__artist.html#gd2895555bb48514986823733a7afe5e2">sp_artist_name</a>(artist));
}


<span class="keyword">static</span> <span class="keywordtype">void</span> got_toplist(<a name="a5"></a><a class="code" href="group__types.html#g723de429cd073bcf5d13fb4e0f466ffd" title="A handle to a toplist browse result.">sp_toplistbrowse</a> *result, <span class="keywordtype">void</span> *userdata)
{
    <span class="keywordtype">int</span> i;

    <span class="comment">// We print from all types. Only one of the loops will acually yield anything.</span>

    <span class="keywordflow">for</span>(i = 0; i &lt; <a name="a6"></a><a class="code" href="group__toplist.html#ge2f5c09fbbf947834b1b1e73461f1fb3">sp_toplistbrowse_num_artists</a>(result); i++)
        print_artist(i + 1, <a name="a7"></a><a class="code" href="group__toplist.html#g504cc45074d40c817dffbcc2906ef57f">sp_toplistbrowse_artist</a>(result, i));

    <span class="keywordflow">for</span>(i = 0; i &lt; <a name="a8"></a><a class="code" href="group__toplist.html#g69f5e70269c1eb08e1ddb1c77bb8c3e3">sp_toplistbrowse_num_albums</a>(result); i++)
        print_album(i + 1, <a name="a9"></a><a class="code" href="group__toplist.html#ga080ace445d269f56942ac3d7f1f157e">sp_toplistbrowse_album</a>(result, i));

    <span class="keywordflow">for</span>(i = 0; i &lt; <a name="a10"></a><a class="code" href="group__toplist.html#geb0ddfd565474dc7e444aabebbc119b7">sp_toplistbrowse_num_tracks</a>(result); i++) {
        printf(<span class="stringliteral">"%3d: "</span>, i + 1);
        print_track(<a name="a11"></a><a class="code" href="group__toplist.html#gf3d00b8bf089134a4f320a8d3d6ab683">sp_toplistbrowse_track</a>(result, i));
    }

    <a name="a12"></a><a class="code" href="group__toplist.html#g1783e3c4b65f41cf0bac66b1053f05b4">sp_toplistbrowse_release</a>(result);
    cmd_done();
}



<span class="keyword">static</span> <span class="keywordtype">void</span> toplist_usage(<span class="keywordtype">void</span>)
{
    fprintf(stderr, <span class="stringliteral">"Usage: toplist (tracks | albums | artists) (global | region &lt;countrycode&gt; | user)\n"</span>);
}

<span class="keywordtype">int</span> cmd_toplist(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
    <a class="code" href="group__toplist.html#g220f32522efb2828e4f8ffb949af234a">sp_toplisttype</a> type;
    <a class="code" href="group__toplist.html#g6fa5cfed2cbb33f2f64542d0b63f6c8d">sp_toplistregion</a> region;

    <span class="keywordflow">if</span>(argc &lt; 3) {
        toplist_usage();
        <span class="keywordflow">return</span> -1;
    }

    <span class="keywordflow">if</span>(!strcasecmp(argv[1], <span class="stringliteral">"artists"</span>))
        type = <a name="a13"></a><a class="code" href="group__toplist.html#gg220f32522efb2828e4f8ffb949af234a41523e58badf9e3901beea3f53e5d28e" title="Top artists.">SP_TOPLIST_TYPE_ARTISTS</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcasecmp(argv[1], <span class="stringliteral">"albums"</span>))
        type = <a name="a14"></a><a class="code" href="group__toplist.html#gg220f32522efb2828e4f8ffb949af234ae8002818ef10eb2c75ec2058ce11cf6b" title="Top albums.">SP_TOPLIST_TYPE_ALBUMS</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcasecmp(argv[1], <span class="stringliteral">"tracks"</span>))
        type = <a name="a15"></a><a class="code" href="group__toplist.html#gg220f32522efb2828e4f8ffb949af234a6a85f8384ec77cb9cb5746966b0f0e28" title="Top tracks.">SP_TOPLIST_TYPE_TRACKS</a>;
    <span class="keywordflow">else</span> {
        toplist_usage();
        <span class="keywordflow">return</span> -1;
    }


    <span class="keywordflow">if</span>(!strcasecmp(argv[2], <span class="stringliteral">"global"</span>))
        region = <a name="a16"></a><a class="code" href="group__toplist.html#gg6fa5cfed2cbb33f2f64542d0b63f6c8d9e9136541401041c7d5c37708b7a927f" title="Global toplist.">SP_TOPLIST_REGION_EVERYWHERE</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcasecmp(argv[2], <span class="stringliteral">"user"</span>))
        region = <a name="a17"></a><a class="code" href="group__toplist.html#gg6fa5cfed2cbb33f2f64542d0b63f6c8d6912eff58c71f5c74b78f48af5305375" title="Toplist for a given user.">SP_TOPLIST_REGION_USER</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcasecmp(argv[2], <span class="stringliteral">"region"</span>)) {

        <span class="keywordflow">if</span>(argc != 4 || strlen(argv[3]) != 2) {
            toplist_usage();
            <span class="keywordflow">return</span> -1;
        }
        region = <a name="a18"></a><a class="code" href="group__toplist.html#ga078b44491f976af43e4941fd1dd032c">SP_TOPLIST_REGION</a>(argv[3][0], argv[3][1]);
    } <span class="keywordflow">else</span> {
        toplist_usage();
        <span class="keywordflow">return</span> -1;
    }

    <a name="a19"></a><a class="code" href="group__toplist.html#g331a9c3d755ded59b311a801c1b57fea">sp_toplistbrowse_create</a>(g_session, type, region, got_toplist, NULL);
    <span class="keywordflow">return</span> 0;
}
</pre></div> </div>
<hr size="1"><address style="text-align: right;"><small>
Generated on Fri Apr 23 06:20:14 2010.<br>
Copyright &copy; 2006&ndash;2010 Spotify Ltd</small></address>
</body>
</html>
